{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-post-tsx","path":"/2019-12-19-PE","result":{"data":{"post":{"id":"06d0cf0b-3094-5f2c-b62a-c4d7744e3072","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"PE (Portable Executable) 구조 [Windows]","path":"/2019-12-19-PE","tags":["project"],"excerpt":"윈도우 실행 파일의 구조를 분석해보자","created":"2019-12-19T00:00:00.000Z","createdPretty":"19 December, 2019","updated":"2020-01-02T00:00:00.000Z","updatedPretty":"02 January, 2020","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD1UlEQVQ4y52R/U9TZxTHz40h8ZrG+w/MgAx+3DJfwMVgRiyFYmlpS2/LHLCxKSAvjiwLv2BUXDJnnGwLOCarCMgiGwnKcC8Z2xShgNAXqXcU4c7KS0s2XkpBRlvu7dlzHSbshzbLnuST8+R7ks895z4AW05r5U9wyvgJVLOXYnrOuUz9H02V3PvQfaz7lOP4bULf+SfHSHaip8Zl0L6at409WAhflndDxPNt9Qh1ocAM5/MbGXvt/Jyrfg0nGgL43Wkb/nDGQe5BlDLSe5x76Didn1oKHVV9VETh0M8u6sqnX0FDbetO73hgYtWDOP1wLWT91S3Y7jwRPK5ASMq84+vOd/JK6ZLCSrh72x5ZaHvQSDVdqwJz0/vM4nIXHxJ7cHm1U5zxNofd0+aw/+lNQcoWfV1cUXEWXVauBctgXWTh6ChQzS0AZjMwK6vAh0KAC4sgEqSK8wsgCCKgfwW44mKgKyrIVvchsnByDKj2NoCWq8CEA8BjGNDjBpEfA3RaAX93gYAIKPwFXNkJoN+rBHDaogh/tO+gLjVth4/N25nflmS8OyjDqQ2ZOCPIcHqD3EMy4XFAhqTH5RXF0G+Vx0DXwI7IwlSrgtpjTgICc2Rey2eHWNQEWVEdfFZREzIKUkZ6XFzJi/Tu0gQ41C+PLFSOZVAH2pJhf+M+xhDU89rlbFR7s8TsP9UokTWjEnR+LeYE9VxsQSydWJkICltaZGH6QyWV3HoA9tTvZXICBl41pUaFPV3MnFShhHxYIWR5NEh63AvGXXTiyURIG1FEEY69RiW3vQIERreeyRtRjQRxs6IJNYJUdetKLqEijky4G+T2lMjCw99XU/suFsDeC/mM2lnLaycvY/ajOjH7UT0+Y7xOkDLS4+JeT6Hj30yF1M6qKBPecFDJZ69B0umrjK53mWeHN9AwFBAJuIkgZbpeHxevL6ITTGUgbx6MIvxmgEo+9wUk1XzO6CwenrX5kLX7RJPzKZpGV5G1LQlSpuuf5eINhXRCbhHIr/8STThEhFcg6WwDo+v38kb7Kur6PGLmLQce6XaifuAPwWhfIZmXCN8mwmIivPMfhX3/CLX3ZsWMjmFUdtr+h/DrwS0TzvGs1U/W9Aum0bWw8cFamLUuk5X9ZOUtwtYowoznE9Y07NRb5iZY2woSyYZhxCdKkHtIysjHnM+FadfvRhYqblgoMh3sP3OZIavOGoaXMOf+AmFxkwWUMm3vDB+fQx7FVASHW6I8SspnHfDyux/ASydrYtLbBzSZNx355N8dJbyxyVGSFSjaLapdSsO2WFUuHLzY9i/H34qBYGX7khrXAAAAAElFTkSuQmCC","aspectRatio":1,"src":"/static/7361d20491e2be78c01bd0f85fdc04fa/5498c/PE_PE.png","srcSet":"/static/7361d20491e2be78c01bd0f85fdc04fa/dc47e/PE_PE.png 200w,\n/static/7361d20491e2be78c01bd0f85fdc04fa/9f2d5/PE_PE.png 400w,\n/static/7361d20491e2be78c01bd0f85fdc04fa/5498c/PE_PE.png 450w","sizes":"(max-width: 450px) 100vw, 450px"}}}},"html":"<h2 id=\"-들어가기-전에-\" style=\"position:relative;\"><a href=\"#-%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90-\" aria-label=\" 들어가기 전에  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 들어가기 전에 ]</h2>\n<p>  이 블로그에서는 32bit 실행파일을 예시로 설명하고 있습니다. 구조체의 크기나 Offset, ImageBase 등에서 64bit 실행파일과 차이가 있겠지만 전반전인 내용에 있어서는 크게 차이가 없으니 양해 바랍니다.  </p>\n<h2 id=\"-pe-portable-executable-란-\" style=\"position:relative;\"><a href=\"#-pe-portable-executable-%EB%9E%80-\" aria-label=\" pe portable executable 란  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ PE (Portable Executable) 란? ]</h2>\n<p>  PE는 EXE, DLL 등의 윈도우에서 실행 가능한 파일들의 파일 형식입니다. PE 구조에서 실행 파일을 분석하기 위해 어떤 내용이 있는지, 그리고 어떻게 활용할 수 있는지 살펴보겠습니다. 이번에는 PE에 대한 모든 것을 파헤치는 것이 아니라 전체적인 구조와 알아두면 유용한 내용을 중심으로 다루겠습니다.  </p>\n<h2 id=\"-구조-\" style=\"position:relative;\"><a href=\"#-%EA%B5%AC%EC%A1%B0-\" aria-label=\" 구조  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 구조 ]</h2>\n<p>  <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7361d20491e2be78c01bd0f85fdc04fa/fc2a6/PE_PE.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD1UlEQVQ4y52R/U9TZxTHz40h8ZrG+w/MgAx+3DJfwMVgRiyFYmlpS2/LHLCxKSAvjiwLv2BUXDJnnGwLOCarCMgiGwnKcC8Z2xShgNAXqXcU4c7KS0s2XkpBRlvu7dlzHSbshzbLnuST8+R7ks895z4AW05r5U9wyvgJVLOXYnrOuUz9H02V3PvQfaz7lOP4bULf+SfHSHaip8Zl0L6at409WAhflndDxPNt9Qh1ocAM5/MbGXvt/Jyrfg0nGgL43Wkb/nDGQe5BlDLSe5x76Didn1oKHVV9VETh0M8u6sqnX0FDbetO73hgYtWDOP1wLWT91S3Y7jwRPK5ASMq84+vOd/JK6ZLCSrh72x5ZaHvQSDVdqwJz0/vM4nIXHxJ7cHm1U5zxNofd0+aw/+lNQcoWfV1cUXEWXVauBctgXWTh6ChQzS0AZjMwK6vAh0KAC4sgEqSK8wsgCCKgfwW44mKgKyrIVvchsnByDKj2NoCWq8CEA8BjGNDjBpEfA3RaAX93gYAIKPwFXNkJoN+rBHDaogh/tO+gLjVth4/N25nflmS8OyjDqQ2ZOCPIcHqD3EMy4XFAhqTH5RXF0G+Vx0DXwI7IwlSrgtpjTgICc2Rey2eHWNQEWVEdfFZREzIKUkZ6XFzJi/Tu0gQ41C+PLFSOZVAH2pJhf+M+xhDU89rlbFR7s8TsP9UokTWjEnR+LeYE9VxsQSydWJkICltaZGH6QyWV3HoA9tTvZXICBl41pUaFPV3MnFShhHxYIWR5NEh63AvGXXTiyURIG1FEEY69RiW3vQIERreeyRtRjQRxs6IJNYJUdetKLqEijky4G+T2lMjCw99XU/suFsDeC/mM2lnLaycvY/ajOjH7UT0+Y7xOkDLS4+JeT6Hj30yF1M6qKBPecFDJZ69B0umrjK53mWeHN9AwFBAJuIkgZbpeHxevL6ITTGUgbx6MIvxmgEo+9wUk1XzO6CwenrX5kLX7RJPzKZpGV5G1LQlSpuuf5eINhXRCbhHIr/8STThEhFcg6WwDo+v38kb7Kur6PGLmLQce6XaifuAPwWhfIZmXCN8mwmIivPMfhX3/CLX3ZsWMjmFUdtr+h/DrwS0TzvGs1U/W9Aum0bWw8cFamLUuk5X9ZOUtwtYowoznE9Y07NRb5iZY2woSyYZhxCdKkHtIysjHnM+FadfvRhYqblgoMh3sP3OZIavOGoaXMOf+AmFxkwWUMm3vDB+fQx7FVASHW6I8SspnHfDyux/ASydrYtLbBzSZNx355N8dJbyxyVGSFSjaLapdSsO2WFUuHLzY9i/H34qBYGX7khrXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PE PE\"\n        title=\"PE PE\"\n        src=\"/static/7361d20491e2be78c01bd0f85fdc04fa/fc2a6/PE_PE.png\"\n        srcset=\"/static/7361d20491e2be78c01bd0f85fdc04fa/5a46d/PE_PE.png 300w,\n/static/7361d20491e2be78c01bd0f85fdc04fa/fc2a6/PE_PE.png 450w\"\n        sizes=\"(max-width: 450px) 100vw, 450px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br>\nPE는 크게 DOS Header, NT Header, Section Header, Section으로 구성되어 있습니다.  </p>\n<h2 id=\"-dos-header\" style=\"position:relative;\"><a href=\"#-dos-header\" aria-label=\" dos header permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ DOS Header]</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_DOS_HEADER</span> <span class=\"token punctuation\">{</span>      <span class=\"token comment\">// DOS .EXE header</span>\n  WORD   e_magic<span class=\"token punctuation\">;</span>                     <span class=\"token comment\">// Magic number</span>\n  WORD   e_cblp<span class=\"token punctuation\">;</span>                      <span class=\"token comment\">// Bytes on last page of file</span>\n  WORD   e_cp<span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// Pages in file</span>\n  WORD   e_crlc<span class=\"token punctuation\">;</span>                      <span class=\"token comment\">// Relocations</span>\n  WORD   e_cparhdr<span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// Size of header in paragraphs</span>\n  WORD   e_minalloc<span class=\"token punctuation\">;</span>                  <span class=\"token comment\">// Minimum extra paragraphs needed</span>\n  WORD   e_maxalloc<span class=\"token punctuation\">;</span>                  <span class=\"token comment\">// Maximum extra paragraphs needed</span>\n  WORD   e_ss<span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// Initial (relative) SS value</span>\n  WORD   e_sp<span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// Initial SP value</span>\n  WORD   e_csum<span class=\"token punctuation\">;</span>                      <span class=\"token comment\">// Checksum</span>\n  WORD   e_ip<span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// Initial IP value</span>\n  WORD   e_cs<span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// Initial (relative) CS value</span>\n  WORD   e_lfarlc<span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// File address of relocation table</span>\n  WORD   e_ovno<span class=\"token punctuation\">;</span>                      <span class=\"token comment\">// Overlay number</span>\n  WORD   e_res<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// Reserved words</span>\n  WORD   e_oemid<span class=\"token punctuation\">;</span>                     <span class=\"token comment\">// OEM identifier (for e_oeminfo)</span>\n  WORD   e_oeminfo<span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// OEM information; e_oemid specific</span>\n  WORD   e_res2<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>                  <span class=\"token comment\">// Reserved words</span>\n  LONG   e_lfanew<span class=\"token punctuation\">;</span>                    <span class=\"token comment\">// File address of new exe header</span>\n<span class=\"token punctuation\">}</span> IMAGE_DOS_HEADER<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PIMAGE_DOS_HEADER<span class=\"token punctuation\">;</span></code></pre></div>\n<p>  DOS 헤더는 PE 파일의 시작 부분입니다. DOS 헤더에서 의미 있게 살펴볼 부분은 <strong>e_magic</strong> 과 <strong>e_lfanew</strong> 정도입니다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 983px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77d41f616bb8b0348066c7a49c2162c0/91b29/PE_DOS.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACnUlEQVQ4y4WT227TQBCG/S6lEhISpfAEPB6tClzwNHBLxR1IpUkTkjgnx/aefYodx4l/ZtcJaRESF6PxjsffzPyz9t5+usOLqwFevv+FNx9HeE12Qc+XH0a4tM/kL24Gzr+i+Pm7Ic6uxnh2fbLnNxOcX49wRu+8UGUQIoTRGoJzaKWRpSmdFeIwRJHnFGfgjCFcrShXoG1b7Pf7J9Y0W8ikgLdkAlHkI6YPgpgh1hmkVNhsKgfeNQ12uwZFkWO9LlwcaAm6R/sISAdUTQtvEabwfYVwQR2Ml5BRAqkK5PmWAHsCNe45z3fIsi0VqZGYmt5tqdCOwDgAW8QygZekW4TxHmousPr8BbI3gMlyKKmh1COjs1AGwlDBJEWS26I56s2Giq6xrWsCGnhS1/AnJYSsILUEIx35P0wo0vTnPeLbb4i+3sLc3aOu7RRr6jxDVZYweQlPEXA6rUjsElJw0jMGYxzM6klmYYz0tcZnc8SDIYL7HvR8QeOT3kIiouUxFkOl665DC5S2Q8kJErsuLZQLu7DIwWycS5rAdkoQQ13FVDwkmM1JEgOdlY+BJX0YuYQwjDoA5y65g/I/MVvAGIPlYoHRaEw2wnK5hMqoQ2WshhUllZTMXFU7qr1vR/2O0CPQvje0nNl0isFggId+n5qadiNbDX2/osROw1Ww6sa2uh26OcKcjoeYovHH1F2/13M+CIITcHoEyuNS2Gm7h07/9gldHcG7fPsj2OvjgEJ1GmqzoeTTlgUJbz+2voOLJ15rQ79l4a6O3XZJ10bZpaRpg8V8g0RXMEpAEVTTOEoK8sJ5GzuetZKQBMzpt6yryllZFNhva+g0h/f9YY67YYxpmMAPBfzV/20ScMxijQUzmEUKP/oTjJcxhoHCb5PzUC0wn+kHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PE DOS\"\n        title=\"PE DOS\"\n        src=\"/static/77d41f616bb8b0348066c7a49c2162c0/91b29/PE_DOS.png\"\n        srcset=\"/static/77d41f616bb8b0348066c7a49c2162c0/5a46d/PE_DOS.png 300w,\n/static/77d41f616bb8b0348066c7a49c2162c0/0a47e/PE_DOS.png 600w,\n/static/77d41f616bb8b0348066c7a49c2162c0/91b29/PE_DOS.png 983w\"\n        sizes=\"(max-width: 983px) 100vw, 983px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>  </p>\n<ul>\n<li><strong>e_magic (2 byte)</strong><br>\nDOS의 Signature로 4D 5A ('MZ') 값을 가집니다.  </li>\n<li><strong>e_lfanew (4 byte)</strong><br>\nNT 헤더의 파일 주소 값입니다.  </li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;Little-Endian&gt;\n컴퓨터에서 데이터를 저장할 때 byte 단위로 저장하는데 하위 byte부터 기록하는 것이 Little-Endian입니다.  \n4 byte 크기의 값 0x1A2B3C4D는 Little-Endian으로 4D 3C 2B 1A으로 저장됩니다.  </code></pre></div>\n<h2 id=\"-nt-header-\" style=\"position:relative;\"><a href=\"#-nt-header-\" aria-label=\" nt header  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ NT Header ]</h2>\n<p>  <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9409a2c36606d789c51d3a8e2e2cdfc7/6af66/PE_NT_header.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQoz42Sy0oDQRBFr0Zd+BeKS0GDC78ozM69SPb5nTHZJASyEiSbKIqCBt8vMGp8O5l22lM9PlAX2lB0zVTVrXurWvrjLC19uoXDQ1X6fTVaLcX1uqrcy8fHqvEvbrc1ublJ1tGRROLQ1ZVGCBRubnK7vVWB2Ij3GpqYUIHUsetrrSSJ/Omp/Pm5PDX+6Sm3jQ3N7e4qBzs4kAgqTSXnJECCT1Hwp6c1bjdg9edneQoTatz6ulLqXokl29uaha20vy/t7Wnm8lILJJdeXhQBFtG11OtpYXVV8wZmdn+vJjEPe4dlgGXGjn9ua0tFwxIyhZRFSzQZyDQG/uJCHraeWNmYcobxmzT0mDPpg4Ey+358lGN+xSCZeZncAIjvYRVAzf8APDvLASlswtRj7v3O7M4yuZ0dFRmfZPP7kPzwoBJFEd0j839KvrtTk1n5tTU5U8Eisk4nNHc0LRo52/LnUpiHmGNYDFJ+LYVmYSnMMiHX0TTFf4VA0u1q9uTkn89maio8m1FAVt6lfjMkeyTPBcl/nXL562HDoALLBtJjmFWxZaxG85gxTDIOvQHbPZIIKPLIOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PE NT header\"\n        title=\"PE NT header\"\n        src=\"/static/9409a2c36606d789c51d3a8e2e2cdfc7/6af66/PE_NT_header.png\"\n        srcset=\"/static/9409a2c36606d789c51d3a8e2e2cdfc7/5a46d/PE_NT_header.png 300w,\n/static/9409a2c36606d789c51d3a8e2e2cdfc7/0a47e/PE_NT_header.png 600w,\n/static/9409a2c36606d789c51d3a8e2e2cdfc7/6af66/PE_NT_header.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br>\nNT 헤더는 <strong>Signature, File Header, Optional Header</strong>로 이루어져 있습니다.  </p>\n<p>  <strong>Signature</strong> (4 byte)는 50 45 00 00 ( 'PE..') 값을 가지며 이는 PE 파일임을 나타냅니다.    </p>\n<ul>\n<li>\n<p><strong>File Header</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_FILE_HEADER</span> <span class=\"token punctuation\">{</span>\n    WORD    Machine<span class=\"token punctuation\">;</span>\n    WORD    NumberOfSections<span class=\"token punctuation\">;</span>\n    DWORD   TimeDateStamp<span class=\"token punctuation\">;</span>\n    DWORD   PointerToSymbolTable<span class=\"token punctuation\">;</span>\n    DWORD   NumberOfSymbols<span class=\"token punctuation\">;</span>\n    WORD    SizeOfOptionalHeader<span class=\"token punctuation\">;</span>\n    WORD    Characteristics<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> IMAGE_FILE_HEADER<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PIMAGE_FILE_HEADER<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><strong>NumberOfSection</strong><br>\nsection의 수입니다.  </li>\n<li><strong>TimeDateStamp</strong><br>\n컴파일된 시간을 의미합니다.  </li>\n<li><strong>SizeOfOptionalHeader</strong><br>\n시스템에 따라 32bit 용은 0xE0, 64bit 용은 0xF0의 값을 가집니다. 이것에 따라 다음에 설명할 Optional Header 구조체가 달라지는데, 다음은 32bit Optional Header입니다.  </li>\n</ul>\n</li>\n<li>\n<p><strong>Optional Header</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_OPTIONAL_HEADER</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//</span>\n    <span class=\"token comment\">// Standard fields.</span>\n    <span class=\"token comment\">//</span>\n    WORD    Magic<span class=\"token punctuation\">;</span>\n    BYTE    MajorLinkerVersion<span class=\"token punctuation\">;</span>\n    BYTE    MinorLinkerVersion<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfCode<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfInitializedData<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfUninitializedData<span class=\"token punctuation\">;</span>\n    DWORD   AddressOfEntryPoint<span class=\"token punctuation\">;</span>\n    DWORD   BaseOfCode<span class=\"token punctuation\">;</span>\n    DWORD   BaseOfData<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//</span>\n    <span class=\"token comment\">// NT additional fields.</span>\n    <span class=\"token comment\">//</span>\n    DWORD   ImageBase<span class=\"token punctuation\">;</span>\n    DWORD   SectionAlignment<span class=\"token punctuation\">;</span>\n    DWORD   FileAlignment<span class=\"token punctuation\">;</span>\n    WORD    MajorOperatingSystemVersion<span class=\"token punctuation\">;</span>\n    WORD    MinorOperatingSystemVersion<span class=\"token punctuation\">;</span>\n    WORD    MajorImageVersion<span class=\"token punctuation\">;</span>\n    WORD    MinorImageVersion<span class=\"token punctuation\">;</span>\n    WORD    MajorSubsystemVersion<span class=\"token punctuation\">;</span>\n    WORD    MinorSubsystemVersion<span class=\"token punctuation\">;</span>\n    DWORD   Win32VersionValue<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfImage<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfHeaders<span class=\"token punctuation\">;</span>\n    DWORD   CheckSum<span class=\"token punctuation\">;</span>\n    WORD    Subsystem<span class=\"token punctuation\">;</span>\n    WORD    DllCharacteristics<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfStackReserve<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfStackCommit<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfHeapReserve<span class=\"token punctuation\">;</span>\n    DWORD   SizeOfHeapCommit<span class=\"token punctuation\">;</span>\n    DWORD   LoaderFlags<span class=\"token punctuation\">;</span>\n    DWORD   NumberOfRvaAndSizes<span class=\"token punctuation\">;</span>\n    IMAGE_DATA_DIRECTORY DataDirectory<span class=\"token punctuation\">[</span>IMAGE_NUMBEROF_DIRECTORY_ENTRIES<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> IMAGE_OPTIONAL_HEADER32<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PIMAGE_OPTIONAL_HEADER32<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><strong>ImageBase</strong><br>\n실행되어 메모리에 올라올 때 실행 파일의 시작 주소입니다.  </li>\n<li><strong>NumberOfRvaAndSizes</strong><br>\nDataDirectory 배열의 길이입니다. (일반적으로 16이지만 항상은 아니기 때문에 이 값을 따르는 것이 좋다고 합니다.)  </li>\n<li><strong>DataDirectory</strong><br>\nSection과 관련되며 내용이 많기 때문에 뒤에서 설명하겠습니다.    </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"-section-header-\" style=\"position:relative;\"><a href=\"#-section-header-\" aria-label=\" section header  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ Section Header ]</h2>\n<p>  Section Header는 File Header에 있는 NumberOfSections 길이의 배열로 이루어져 있습니다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/98e1688b87caa161787cf9b5d2fc5130/6af66/PE_section_header.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuklEQVQoz42SWy8DQRTHB4l60A8gsbz6AOK9tt3dWrttd7YpffDAg8uDaNrGg/oevo9IlBAtpSoiQdwFidteusd/GpcXETs5mTl7zvzmzP8Mk8akDikjdWEO9WX7QtK4FBJrMfdP9IfCA+HOHr2ne5EWmXFtzMeP4hSrxEg9UEnZU0jelCm6HSW1phLiBZE0Zb1Z59zlFe7w2re5vIr/JyMnI5ksZRkAzLgyZuGTVtfc+HHcB7wJaFM71Bz9TKfRi9EFlnxKLnGPkx3YP9a0KY0h1omHxHTiPsHMW5MZl8acAALuARZoDY2UqhKoddXTT3UCNMesV6tg3pgkl+XX6FbURZIbWYs4w+vDb8nHJOHAKYCZeWcK6JyAIM9DVYGyiytvyAGuLXxCTo5hU0lUkv5liEpR4QwO/K4w9ZwiFOGlXlKBWH/OHg4mxHPMuDEmkNCAbuvWu7X5ZfDL0LAGrfgkTTLoJvSeQYxs33agsQ+QD7n8lu9w0ZQFRkR/Gr723nRvd4lKTIgOcKuz6r5KsZ0YQRohV8sHsPgfIMtTvm2FVlhkNTKEhizh2RQALgrDkynCz6Pby4gNfgAmJVtVRvJEqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PE section header\"\n        title=\"PE section header\"\n        src=\"/static/98e1688b87caa161787cf9b5d2fc5130/6af66/PE_section_header.png\"\n        srcset=\"/static/98e1688b87caa161787cf9b5d2fc5130/5a46d/PE_section_header.png 300w,\n/static/98e1688b87caa161787cf9b5d2fc5130/0a47e/PE_section_header.png 600w,\n/static/98e1688b87caa161787cf9b5d2fc5130/6af66/PE_section_header.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br>\n.text, .idata, .data, .rsrc 등의 섹션이 있으며 하나의 section_header는 다음과 같은 정보들을 가지고 있습니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_SECTION_HEADER</span> <span class=\"token punctuation\">{</span>\n  BYTE    Name<span class=\"token punctuation\">[</span>IMAGE_SIZEOF_SHORT_NAME<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n          DWORD   PhysicalAddress<span class=\"token punctuation\">;</span>\n          DWORD   VirtualSize<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> Misc<span class=\"token punctuation\">;</span>\n  DWORD   VirtualAddress<span class=\"token punctuation\">;</span>\n  DWORD   SizeOfRawData<span class=\"token punctuation\">;</span>\n  DWORD   PointerToRawData<span class=\"token punctuation\">;</span>\n  DWORD   PointerToRelocations<span class=\"token punctuation\">;</span>\n  DWORD   PointerToLinenumbers<span class=\"token punctuation\">;</span>\n  WORD    NumberOfRelocations<span class=\"token punctuation\">;</span>\n  WORD    NumberOfLinenumbers<span class=\"token punctuation\">;</span>\n  DWORD   Characteristics<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> IMAGE_SECTION_HEADER<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PIMAGE_SECTION_HEADER<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><strong>Name</strong>\n섹션의 이름입니다. 모두 길이가 8을 넘지 않는 짧은 길이기 때문에 주소값이 아니라 문자열 자체가 header에 들어있습니다.  </li>\n<li><strong>VirtualSize</strong><br>\nSection의 크기입니다.  </li>\n<li><strong>VirtualAddress</strong><br>\n파일이 실행될 때 메모리에 올라오는 Section의 주소 (Image Base로부터의 Offset)입니다.  </li>\n<li><strong>PointerToRawData</strong><br>\n파일 내부에서 Section의 주소입니다. (이를 줄여서 <strong>Raw</strong>라고 부르겠습니다.)  </li>\n<li><strong>Characteristics</strong><br>\nSection의 쓰기/읽기/실행 가능 여부의 속성입니다.  </li>\n</ul>\n<p>  *※ PE 구조 내에서의 VirtualAddress는 대부분 <strong>RVA (Relative Virtual Address)</strong>, 즉 Image Base로부터의 <strong>상대 주소</strong>입니다.*  </p>\n<p>  메모리에서의 주소(VirtualAddress)와 파일에서의 주소(PointerToRawData)가 따로 존재하는데, 이는 PE 파일의 모습과 실행되어 메모리에 올라온 모습이 다르기 때문입니다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/885b00e5fe788fcd3207a0308eeaf3c9/6af66/PE_file_memory.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFT0lEQVQ4y11UC0yTVxQ+CIiMaeYmEDO3JdNNJwNa3BBFR1TAx8bUxUUz3bJM6RyMLGEBHe+CYiLq4tRkuiyARWGE+RhYFCggUBDkTUHeLX3RJ+XV0t/e/me3dYDZSb7cc/577ne/c++5PwC15GsXoCKh94OmNOW2c1/e+Cw56sIX1A+tSOzdiIjgAPwMcDjxO2iPN3qUxInDkqIuHIsLTz2auO/cV5eP3T7YkWVYJbtE8+RSdKGc7m3X9aKRAhabrqko1OxIgR07bhjr5wn9EjhesBfcr6QVBQ3kMzh6C7HuspTty52zDwlsKL4ij3lyVQWQI0lfAn7wmlbT+2DOLMPB/lrbYH+NzWKWol77rNKpjtqapNWrKOEbl0r4IeYZ2ZxBJ8Gerkf2cVWbjcY4Jms/oVJ0Ad19iyPfdXLaR2i2+KJC6WMblfqQWbMvTs/4iBCDnQp3XFy2jOa53K1eGcg892X0Bl+UK3zsCqWvzcr4olrjzdPqvQGOV4ArwGrXGROUMxZAjRqIYgyIlfqzkyB6ITAAQs+7eAIEujwQQQCxAmMyAqqVwDrybVa6Tgk8/ThNXSfwdqODx4+asPKYvs34fROXRNcGkJOdH2OcNowSFjhL9uYvXw7u4LG/MjDoJ30Yw2vk4smWIPZEdQCJGd6KseNhvDjjDnCWcxiPQ+TYAWFY+z7cUhNBgst3ke3NezBSfkD0ELtg/mK4whAIa9q7IVJ5kKF5uLUukg1+sJPs7IvCCOl+3m7lwReE3+DXEKELF255EoLcexzif+tDsvlxMEZow0WleN+Zw3kY6LpPuxe2t4ZuDNfuYoLuc3BTGZf1F/iRTyTbMFIXztsztRsgsmynq+NSCjW5whL1TSweu0n+kt4kxfJ8LNLkVs2rcyDuYSxcbb+8vthUyBSOCbBQLmBvDeeTIk0B5qn+jL6pyQXY8MduN/ACz9RmnfDcAEF+m4HwW/Xk3CDBtBaDaJ7s/YyNy+nGS29X3OXOWNA6Z0OcI8hSEBqjQjUZrVJPA7z9W4i7o7Fj6waF8Z16jKnqIT9UdJL4Th3G1g+L5vvQOzXwFTosCf09l3OoQckcEqvx0ztP2YPVI+SQWIVRZV28z8slAK/z3/KCrbAyoX6wPJWSJFRLSHx5K0np0GCieHhB4fpMroPQ7WJpUWCLZopp1c1gs9LAPtVMERpjVb8sunpQAfDOrx8tdbRNknhImNWjx19E3eT0ozaS2a3D5MZFwjfTArwchEfy8jjpXTomo1uP8f+IWbqOZPQYMKG2j5dYPwjgc3atJ/jDipQno8IzvROY3iIj6c1ScqbXiKnNsoWSOdmbPR0lF4hKAxTTc4zKzKDKYmPV5ueExiiRj0f3KbX0bM5QwkBYkdgwVJ5OdzpV+4wkinpIOlVwSjzykkJ/L/AA96P5udyzPXomu9eAqdVdbFabgmRLDJhc389LFQ8BbCo64mgbF1qes+SUumckqabHWXJK4yLhe3znpbhl/V3AqZIbmWqlCR/1j7FVUh2pkk/g3a7h6PuSUVjoMbvVUoYvjPwHZK1zC334Lp+eoRe4fyvI4+ZI9MzFZ0Y82zjAnu8eJzlULb9hgJfZNLRIOD0zW2Z3MNntzylsDn9mdrZyfn5dht+r9Dfinlicz70jNVnvyaewZEBtvyM12u7ITJjfMRIt6JYtEprN5of4P7NYLDXz82szg5x9eExQGMjv1rOZjvOu6MC0pwrkO/zH/SdPN7ykUKVSZZtMpsaJiYlKB6gvpt9yXn5610uvQbu4eY1RO/5oUq+rnjToqygqjVpN4+jgwD7Z8BD8C/ew3yDbomChAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PE file memory\"\n        title=\"PE file memory\"\n        src=\"/static/885b00e5fe788fcd3207a0308eeaf3c9/6af66/PE_file_memory.png\"\n        srcset=\"/static/885b00e5fe788fcd3207a0308eeaf3c9/5a46d/PE_file_memory.png 300w,\n/static/885b00e5fe788fcd3207a0308eeaf3c9/0a47e/PE_file_memory.png 600w,\n/static/885b00e5fe788fcd3207a0308eeaf3c9/6af66/PE_file_memory.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>  </p>\n<p>  Header까지는 크기와 상대 위치가 같지만 Section에서 차이가 있습니다.  </p>\n<h2 id=\"-datadirectory-따라가기-\" style=\"position:relative;\"><a href=\"#-datadirectory-%EB%94%B0%EB%9D%BC%EA%B0%80%EA%B8%B0-\" aria-label=\" datadirectory 따라가기  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ DataDirectory 따라가기 ]</h2>\n<p>  DataDirectory는 앞에서 봤던 NT Header의 Optional Header의 끝부분에 있는 구조체 배열입니다. 여기에는 <strong>Import Table, Resource Table, TLS Table</strong> 등의 데이터의 주소 정보를 담고 있습니다. 실제 데이터는 Section 영역에 포함되어 있습니다.   </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_DATA_DIRECTORY</span> <span class=\"token punctuation\">{</span>\n  DWORD   VirtualAddress<span class=\"token punctuation\">;</span>\n  DWORD   Size<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> IMAGE_DATA_DIRECTORY<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PIMAGE_DATA_DIRECTORY<span class=\"token punctuation\">;</span></code></pre></div>\n<p>  DataDirectory 구조체를 보면 파일에서의 주소는 명시되어 있지 않습니다. 하지만 이 데이터는 특정 Section에 속해 있기 때문에 Section Header의 정보들을 통해서 다음과 같이 <strong>Raw (파일 주소)</strong>를 구할 수 있습니다.  </p>\n<ol>\n<li>\n<p><strong>Data가 어느 Section에 속해 있는지 확인한다.</strong>  </p>\n<ol>\n<li><strong>Virtual Address (Data) > Virtual Address (Section A)</strong>  </li>\n<li><strong>Virtual Address (Data) &#x3C; Virtual Address (Section A) + Virtual Size (Section A)</strong><br>\n이 두 가지를 모두 만족한다면 Data는 Section A에 속해 있습니다.  </li>\n</ol>\n</li>\n<li><strong>해당 Section Header의 정보를 통해서 Raw를 계산한다.</strong><br>\n<strong>Raw (Data)</strong>를 구하기 위해서는 이 데이터를 포함한 섹션의 시작점으로부터 얼마나 떨어져 있는지 <strong>(Offset)</strong> 계산해야 합니다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7574e58ab5b5e279ff2e4cfce5f770ab/00d43/PE_data_raw.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACv0lEQVQozy2SaUhUURTHzywpmjZTGiKMFJmEhkUkgiZ9iBbQPkRBJYQLFVaYqQllTmoWEVnS4lKWRhmjSfklctxGm81hdNKymcFxY7Iy1NFZfc7a6d5nF37vnHPv4f+/h/sAAEFe+BQQEdD1C8gKJ4SO9XSs7fW3kzgLIDJBkOgaPWf3yYokhNHe/zVweTzy5SF0lvbSJj4iIyg/mxlflnsqgdThiG4+VuRRCYAEwhFC1GWoam4VJCanpO5OSUtK2n9gb3l9swD2pMIhVvY4RlDxUe1IzujvJZ9hwbloWHBYRn9aVtXar0elxP3CR+TBeeRCJHJg4z0eehgZMXQR/hDc6GW68F0LiKPIpQt2XY8mviE3mrouFUmNWEy42jWOxZ1GvFkjySJXh33H+kKid6pjNseptz7akBHRYprXSX44sc3sQBpbDHM6HRmf6HDAIwoWEhtwVtZm+6vq0JAv9pmuVPj9VfVovVWXbi8QA6bsCNKFCqP1/OCYeYBNj1/2DFU39eLtZ588Na9k+KRRqlUCrGcFtyByWmvboLFVniX5oME37Srf63ZVQPJegw1vZRn1HUNwmvTgQfY1IJcXycU7DVqnuAa/XSz12sseIN59rsScPHiYlAowPT7Bn/b4Ycruyp4LIM7jGjQ3LdszJq0OmJyY4olWEE7mnAFIS4cS2aRGLDdjpXLWI1aYsaRvQsm+x4lzAKt2G4+x22DFZs1Er8ePfp+VYCc547BYDruWl8Fls3Jnv+uhovEFmQk4Frd32P4X0RrAAI2Lbu8g/XWS47YD9CpULD1yxTrlkE6oGv4ioCi0w0KpbIDfPSAHitVigfvV1fQeHC/D9GPA7yPGSyT6PcxKNxWMT0wEMBqNLAaDAWZmZsBsNrPQfGxsDPR6PQsVzS8sYieTa7Rhg7oRoZoY0/iZ1FRwW2ws/AP6XL7Z9TdhHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PE data raw\"\n        title=\"PE data raw\"\n        src=\"/static/7574e58ab5b5e279ff2e4cfce5f770ab/00d43/PE_data_raw.png\"\n        srcset=\"/static/7574e58ab5b5e279ff2e4cfce5f770ab/5a46d/PE_data_raw.png 300w,\n/static/7574e58ab5b5e279ff2e4cfce5f770ab/0a47e/PE_data_raw.png 600w,\n/static/7574e58ab5b5e279ff2e4cfce5f770ab/00d43/PE_data_raw.png 1000w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br>\n<strong>Offset = Virtual Address (Data) - Virtual Address (Section)</strong><br>\n이제 이 값을 Raw (Section)에 더한 것이 Raw (Data)입니다.<br>\n<strong>Raw (Data) = Raw (Section) + Offset</strong><br>\n<strong>= Virtual Address (Data) - Virtual Address (Section) + Raw (Section)</strong>  </li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Converter = Virtual Address (Section) - Raw (Section) 라고 해두고\nRaw (Data) = Virtual Address (Data) - Converter\n이렇게 사용하기도 합니다.  </code></pre></div>\n<h2 id=\"-next-\" style=\"position:relative;\"><a href=\"#-next-\" aria-label=\" next  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ Next ]</h2>\n<p>  DataDirectory가 가리키는 Data의 파일 주소 찾는 법을 알았으니 다음 포스팅에서는 <strong>Resource Table</strong>의 구조를 다뤄보겠습니다.<br>\n</p>"},"primaryTag":{"name":"project","color":"#007acc"}},"pageContext":{"postId":"06d0cf0b-3094-5f2c-b62a-c4d7744e3072","primaryTag":"project"}},"staticQueryHashes":["1116962356","1994268275","2206391224","2275848304","545095672"]}
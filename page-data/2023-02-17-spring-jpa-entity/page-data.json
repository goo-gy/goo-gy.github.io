{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-post-tsx","path":"/2023-02-17-spring-jpa-entity","result":{"data":{"post":{"id":"59fb98a3-5ba5-5485-a7fc-033b9da37083","headings":[{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2}],"frontmatter":{"title":"[Spring JPA 시작하기] DB 설계","path":"/2023-02-17-spring-jpa-entity","tags":["project","spring","JPA"],"excerpt":"JPA로 DB를 설계해보자","created":"2023-02-25T00:00:00.000Z","createdPretty":"25 February, 2023","updated":"2023-02-25T00:00:00.000Z","updatedPretty":"25 February, 2023","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABS0lEQVQoz51T7XKCQAzkNVpE5ePg4O6gCKgddepM3/+Z0mxsGD/on/7IMLdJNps1Rqt1Qf+JOMkp2Rhq/EC58VTajjappUiT94VLzX9h0/GLQrenomxpm9UUaQLfpcZ7gucAnhWOyQKTWVH8oBDAUqOuV1aB16qkebU20pObhgm94HjPhABqt5OJpmrnAhDdlDTkuyPnOrJuoJTfqPH9hd/jDcube0JLu+lEVf0hhCBeb0sJ1KB4PFzFfPiFN3LT5zcLGWZMPHxfZZIc9xdyYRQyDAARcF3Zt+PvFiCrBK9dzwKC/CDARCE8gXw0JxzqCQbpykoOXL0G9hanUqdeR5AZdmdetRfZaPL9STyBXximlvh2Ejtgi+LP1xCBAIcJYvXF8Wo4BeB6DplxFIYrFTzE2F5q4yR7JVQPH8/k9f7gzzCd538GPFtS+AMpcTYcw89QjQAAAABJRU5ErkJggg==","aspectRatio":1.7543859649122806,"src":"/static/86c863b92312aefcea3848067b714f18/90823/db-schema.png","srcSet":"/static/86c863b92312aefcea3848067b714f18/dc47e/db-schema.png 200w,\n/static/86c863b92312aefcea3848067b714f18/9f2d5/db-schema.png 400w,\n/static/86c863b92312aefcea3848067b714f18/90823/db-schema.png 800w,\n/static/86c863b92312aefcea3848067b714f18/77647/db-schema.png 1200w,\n/static/86c863b92312aefcea3848067b714f18/f1b1a/db-schema.png 1287w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<h2 id=\"-개요-\" style=\"position:relative;\"><a href=\"#-%EA%B0%9C%EC%9A%94-\" aria-label=\" 개요  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 개요 ]</h2>\n<p>JPA에서는 Java Class만 작성하면 자동으로 Database의 Schema를 만들어주는 DDL을 제공해 준다. 이번 포스팅에서는 작은 프로젝트에서 JPA를 활용하여 DB를 설계하고 구현해 볼 예정이다. JPA 기본 문법에 대해서 자세히 적는 대신 설계 방향과 여러 가지 옵션을 활용하는 방법을 중심으로 알아볼 예정이다.</p>\n<hr>\n<h3 id=\"요구-사항\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EA%B5%AC-%EC%82%AC%ED%95%AD\" aria-label=\"요구 사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요구 사항</h3>\n<p>우리가 Spring JPA를 이용해서 어떤 게시글 서비스를 만든다고 가정해 보자. 그러면 우리는 기본적으로 <strong>사용자(Member), 게시글(Posting), 댓글(Comment)</strong>에 대한 정보가 필요할 것이다. 게시글 검색을 더 활성화시키기 위해 <strong>Hashtag(#)</strong>도 추가해 볼 수 있다.</p>\n<p>그리고 다음과 같은 추가적인 요구사항을 만족하는 서비스를 만들어 보자.</p>\n<ul>\n<li>사용자에게 Email, password를 이용하는 로그인 인증과 카카오 로그인을 지원한다.</li>\n<li>모든 DB 테이블에서 생성 시간, 수정 시간을 관리하고, 삭제할 때는 실제 Data를 삭제하는 대신 삭제 표시만 남겨둔다.</li>\n</ul>\n<h2 id=\"-공통-데이터-\" style=\"position:relative;\"><a href=\"#-%EA%B3%B5%ED%86%B5-%EB%8D%B0%EC%9D%B4%ED%84%B0-\" aria-label=\" 공통 데이터  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 공통 데이터 ]</h2>\n<p>그러면 이제 하나씩 JPA를 이용해서 구현해 보자</p>\n<hr>\n<h3 id=\"mappedsuperclass\" style=\"position:relative;\"><a href=\"#mappedsuperclass\" aria-label=\"mappedsuperclass permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MappedSuperclass</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@MappedSuperclass</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@CreationTimestamp</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">LocalDateTime</span> createdTime<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@UpdateTimestamp</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">LocalDateTime</span> updatedTime<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ColumnDefault</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Boolean</span> deleted<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>요구사항에서 삭제 여부, 생성 시간, 수정 시간을 모든 테이블에서 동일하게 관리하기로 하였다.</li>\n<li>이런 필드들을 모든 Entity에 직접 작성하는 대신 <code class=\"language-text\">@MappedSuperclass</code>를 지정한 클래스에 모아두고 이 클래스를 상속받기만 하면 자동으로 해당 컬럼들이 테이블에 반영된다.</li>\n</ul>\n<h2 id=\"-상속관계-\" style=\"position:relative;\"><a href=\"#-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-\" aria-label=\" 상속관계  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 상속관계 ]</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae3bc8ea4fa9a58481b8453b50b36fa1/cd138/member_uml.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACwElEQVQoz42QWU9TURSF921jgygOROqLEggi0CKFDkiYFCiWCAjS3lZuRwqtSsdbyliKKAiIqWBLL52MgqJoIgaj8dXEGBP/gC++GOOLL/4BzXG3CSZGYzzJykn2+fZaex+Av5wCpQ52V52BvbI2gbjT7G/u895sNLqWStsNNgVth3q9g9olaYH/PoWtOgrKGgFKGnKk6oHPTRYPqWUGiajT9K5O74Ams4f3T8N4PJ4Rx3GQSqWgSNVLwREZQK4op8Hg/NTaP0QquvqIpNv6VmllodXq4wkkSkgmkxCNRn/1/2G4o/wWLRys6YDD9V3ZuPKTatr+Qa6xfcQJV2oZB5w2uSkQFGXYRCLxu2GJxg2EEAiFo5iYgBTq2aMH8CV8MVN3Bufg9fbmnvevtrI9U/Pw/MVLGB0ZgXBkBZKJNJ+EpQiXYYt7HACN9iA1fHuNb+O2qYVwLGs5GhOOTc/uP6fWCtUaOnc5HNnHrcaEq7G4cGFxMae7R31IyxjybkW4A1wilcfOhARZbQ6q8WKQf6LXB3Dq0hVwhe7C1OoGphQBCJTQcnkKqiwBKGQmQEw7sf4Dvn/7CirXVWhiQ2C/cQcCK2tA3uCKVBsokVf0jUPGsMrg71A6rz1t81xfU7lmNqXG4Y0q4/B9id6/XqJxFZTil1QyLNVgm+TVWMeRH5Y3D05vqdyz9zp985sKy+jDSoN/HeuPkZWmXYPt7BxpZ+dJvS1IZKZRIjePEqlxhJTSbkUZ7QaRzotmE3x8Q56lMZyc9c4R3I4oLGNEhny6r0zrUUMFMxTo8C2Q7pFFUtMfINV94+SkdYLIERTrvApUOpSHIXycHMQ6VlOHwbW2SSJFkx0+fZdfYHtApPWUo/MAyiRhhszYbKpgfGZ8NB0778hFwXG1E428FNYA18ovpT02nNoo0Wf4TA/KWtzjPPoTVRshgZ16s/MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"member_uml.png\"\n        title=\"member_uml.png\"\n        src=\"/static/ae3bc8ea4fa9a58481b8453b50b36fa1/c1b63/member_uml.png\"\n        srcset=\"/static/ae3bc8ea4fa9a58481b8453b50b36fa1/5a46d/member_uml.png 300w,\n/static/ae3bc8ea4fa9a58481b8453b50b36fa1/0a47e/member_uml.png 600w,\n/static/ae3bc8ea4fa9a58481b8453b50b36fa1/c1b63/member_uml.png 1200w,\n/static/ae3bc8ea4fa9a58481b8453b50b36fa1/cd138/member_uml.png 1220w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Member의 인증 방식에는 Email, Password를 이용한 로그인과, 카카오 인증을 활용하는 방법을 지원하기로 했다. 그래서 Java에서는 Member를 상속받는 LoginMember, KakaoMember 클래스를 만들었다. Java에서는 이 모델을 클래스를 상속함으로써 구현하였지만, Database 상에서는 이런 상속 개념이 없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Inheritance</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">InheritanceType</span><span class=\"token punctuation\">.</span>JOINED<span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@DiscriminatorColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"auth_type\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Member</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>unique <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>대신 <code class=\"language-text\">@Inheritance</code>를 사용하여 상속받는 클래스가 Database 스키마에서 어떻게 구성될지 결정할 수 있다.</p>\n<!-- `@DiscriminatorColumn` 옵션을 지정해주면 테이블에 지정한 이름으로 컬럼이 생기며, 상속 관계를 위해 어느 테이블과 Join 해야할 지 알 수 있다. -->\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginMember</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Member</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@NotNull</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>unique <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> email<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> password<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>@Inheritance 옵션에는 다음과 같이 3가지가 있는데 하나씩 알아보자.</p>\n<ul>\n<li><code class=\"language-text\">SINGLE_TABLE</code></li>\n<li><code class=\"language-text\">JOINED</code></li>\n<li><code class=\"language-text\">TABLE_PER_CLASS</code></li>\n</ul>\n<hr>\n<h3 id=\"single-table\" style=\"position:relative;\"><a href=\"#single-table\" aria-label=\"single table permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Single Table</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1018px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f3afe0dcb1add83b11aa36cd893a0648/3dde1/single_table.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAAA20lEQVQoz52S5w6CQBCEfQ1FNJRTkI5IUYqxvv8TjbtrNMZIIvyYXMntd7M3N5kvbHxrNjfhegk2fiprfalEn3NNt/CrdtIHjJJStHIirN2Exhh+mMMLMpnzuV/QXqAf7gRoKR+KoGodCvylgUADQZRjX58JWsC0PdirQOByAcGHOyRge7wjTisBMIihrHFAarnpbjg0FyTb/dvlSKCBMC5QHU7Y7moKJSanJSWfwrJHtDzVDGm1bq9w6euwu6LqyHUmwGco6n+gpptSxME47Irej93xnoRD6nP4AIy7ADaIEB7lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"single_table.png\"\n        title=\"single_table.png\"\n        src=\"/static/f3afe0dcb1add83b11aa36cd893a0648/3dde1/single_table.png\"\n        srcset=\"/static/f3afe0dcb1add83b11aa36cd893a0648/5a46d/single_table.png 300w,\n/static/f3afe0dcb1add83b11aa36cd893a0648/0a47e/single_table.png 600w,\n/static/f3afe0dcb1add83b11aa36cd893a0648/3dde1/single_table.png 1018w\"\n        sizes=\"(max-width: 1018px) 100vw, 1018px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Single table 전략은 Member를 상속받는 모든 자식 Entity의 필드를 Member 테이블 하나에 넣어두고 필요한 것만 사용하는 전략이다. (나머지는 Null)</p>\n<ul>\n<li>\n<p>장점</p>\n<ul>\n<li>Join 없이 데이터를 가져올 수 있기 때문에 성능이 빠르다.</li>\n</ul>\n</li>\n<li>\n<p>단점</p>\n<ul>\n<li>해당되지 않는 Entity에 대한 컬럼도 한 테이블에 있기 때문에, 자식 Entity에 해당하는 컬럼은 항상 Nullabe로 설정된다.</li>\n<li>자식 Entity에 많은 데이터가 있을 경우 저장 공간 낭비가 심하고, 조회 성능도 느려질 수 있다.</li>\n</ul>\n</li>\n</ul>\n<p>자식 Entity들의 데이터가 적을 때 사용하면 좋을 것 같다.</p>\n<hr>\n<h3 id=\"joined\" style=\"position:relative;\"><a href=\"#joined\" aria-label=\"joined permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Joined</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1043px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26ae7d7f56e25d72528df0d835bf0060/620ae/joined.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABMUlEQVQoz52SSXaDMAyGuUbCbDCTwQYeCXRKs+H+R1IlEVKmLpqFnmxL/vxbkuV4MRzZ2REQJyWkuQEb964vn0Zx240O71l/A0PIVAO6HkCmBsE1qOoCWdGAH2avAAWr03WPSqunyVRDIF4AnuwQclT49T1CqS8gYgWRLBn6L+CceEYgfe/zNkL/dud1JFFhZlbALdjagpZ7ERcMmmAKEiwBqfSCdJW/XFvLA/InO2B1pII66gUJe6qph55yfIxN+WKndKWQIAV2sjRXrhl1k9TMOSkqpViSaY6RuY9Hdl8mBfSdph9BmfdpTMyAvuWHHLykuztU7Q3PGijKDvLqyqWgu/sa4mEYFWCagUdjtgSbMM1dDG338RijKUaPkohj4KoWcmG/MQLkquVyzGO0HaEfJrE2GUXAUcoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"joined.png\"\n        title=\"joined.png\"\n        src=\"/static/26ae7d7f56e25d72528df0d835bf0060/620ae/joined.png\"\n        srcset=\"/static/26ae7d7f56e25d72528df0d835bf0060/5a46d/joined.png 300w,\n/static/26ae7d7f56e25d72528df0d835bf0060/0a47e/joined.png 600w,\n/static/26ae7d7f56e25d72528df0d835bf0060/620ae/joined.png 1043w\"\n        sizes=\"(max-width: 1043px) 100vw, 1043px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Joined 전략은 Member를 상속받는 Entity가 별도의 테이블을 구성하고, Member 테이블과 조인하여 사용하는 전략이다.</p>\n<ul>\n<li>\n<p>장점</p>\n<ul>\n<li>불필요한 Null 데이터를 저장하지 않으므로, 저장 공간 면에서 효율적이다.</li>\n</ul>\n</li>\n<li>\n<p>단점</p>\n<ul>\n<li>Join으로 인해 성능이 저하된다.</li>\n</ul>\n</li>\n</ul>\n<p>Joined 전략이 상속 관계와 가장 유사한 구조를 가지고 있어, 이해하기도 관리하기도 쉽다.\n그리고 하위 테이블의 데이터를 잘 사용하지 않는 경우 나중에 다룰 <code class=\"language-text\">Lazy Load</code>로 보완할 수 있기 때문에\nJoined 옵션을 사용하기로 했다.</p>\n<hr>\n<h3 id=\"table-per-class\" style=\"position:relative;\"><a href=\"#table-per-class\" aria-label=\"table per class permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table Per Class</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1155px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f98a4da2d623d174cbd49f2056bb52e8/b7936/table_per_class.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAAA7klEQVQoz31S7Y6CMBD0NRRBWigtFkolfp65XHL6/q+07qzphTPoj83Q7u7sdJbFuqgJkeUV5RtDqnIcrZxXay2YYqMs6XpLRdn8y6V+4CIRoqAynkI8kQ97qpueGjfwXSeDkPf9nobdmWwbybgg+VK3f2QzhB03HViFl+LWj4JJURcOfI5SZ7c7chz4Rm6WULPCy/VXVKAQAaVPQiX3x/OPEGFobYNgluv3Cq/fd2kyXAwyYFFaWmaK4njh/I364fgkbD4Qwgf44fiZio1PCqcewt84fskQYwfxcvbJ0029bvZ1y/gDgFANxLDpUh4WOcdbdziiuwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"table_per_class.png\"\n        title=\"table_per_class.png\"\n        src=\"/static/f98a4da2d623d174cbd49f2056bb52e8/b7936/table_per_class.png\"\n        srcset=\"/static/f98a4da2d623d174cbd49f2056bb52e8/5a46d/table_per_class.png 300w,\n/static/f98a4da2d623d174cbd49f2056bb52e8/0a47e/table_per_class.png 600w,\n/static/f98a4da2d623d174cbd49f2056bb52e8/b7936/table_per_class.png 1155w\"\n        sizes=\"(max-width: 1155px) 100vw, 1155px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Table per class 전략도 Member를 상속받는 Entity가 별도의 테이블을 생성하지만,\n공통되는 Member의 필드들을 각 테이블에 따로 넣는 전략이다.</p>\n<ul>\n<li>\n<p>장점</p>\n<ul>\n<li>데이터를 완전히 분리하여 단순하고 관리하기 쉽다.</li>\n<li>단순 조회 성능이 빠르다.</li>\n</ul>\n</li>\n<li>\n<p>단점</p>\n<ul>\n<li>부모 Entity를 중심으로 데이터를 가져올 때 굉장히 비효율적이다.</li>\n</ul>\n</li>\n</ul>\n<p>이 전략은 자식 Entity로 명확하게 조회할 때는 괜찮지만, 부모 Entity인 Member 객체로 조회할 때는 login__member, kakao__member 테이블을 모두 union 연산하여 탐색하기 때문에 굉장히 비효율적이다.</p>\n<h2 id=\"-연관관계-\" style=\"position:relative;\"><a href=\"#-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-\" aria-label=\" 연관관계  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 연관관계 ]</h2>\n<ul>\n<li>@OneToOne</li>\n<li>@ManyToOne</li>\n<li>@OneToMany</li>\n<li>@ManyToMany</li>\n</ul>\n<p>JPA에서는 위와 같이 연관관계를 위한 4가지 @Annotaion을 제공한다.</p>\n<hr>\n<h3 id=\"manytoone\" style=\"position:relative;\"><a href=\"#manytoone\" aria-label=\"manytoone permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@ManyToOne</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1027px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7c20e014d81ffe3c3e81db578e04357e/f2d92/member-posting.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAABAklEQVQoz22R63KDIBCF8xyNlygiChqISU2M6WU60/d/pNNdEMe0/cGw7B6+PSy7fSqQZBV4f0lKv/+OYz3NJQrR+jPX49pqdrEoZAc73OiCRlkZSHVEKY2HxAacHy4z6sb6emsGqNZRXq/QJ2Dvrl7IF4L4hLxoglPSFMJA2xmyPS86h8a8+rvMeAJy92n+Qm9HHwsZXLI4LxSyQw2lHTl8BPde06GqQ7xPN0A+8FMv4xvcMHmHLJbKrg5DU43H+zdB7wTqF2D/H1DgQMPm+ZxIzM8NwCM5UyuQm463D1ynT+ju7GE8wz9PjgMNcdj5M5JMbvJiyddIqMYjCEutH8f1H/yXx9F/BVN6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"member-posting.png\"\n        title=\"member-posting.png\"\n        src=\"/static/7c20e014d81ffe3c3e81db578e04357e/f2d92/member-posting.png\"\n        srcset=\"/static/7c20e014d81ffe3c3e81db578e04357e/5a46d/member-posting.png 300w,\n/static/7c20e014d81ffe3c3e81db578e04357e/0a47e/member-posting.png 600w,\n/static/7c20e014d81ffe3c3e81db578e04357e/f2d92/member-posting.png 1027w\"\n        sizes=\"(max-width: 1027px) 100vw, 1027px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Posting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> title<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> content<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"owner_id\"</span><span class=\"token punctuation\">,</span> nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Member</span> owner<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Posting 과 Member의 관계는 N:1이다.<br>\n이럴 때 @ManyToOne을 사용한다. DB 상에서는 당연히 Many 쪽에서 Foreign Key를 가지기 때문에 @ManyToOne을 지정한 곳에 @JoinColumn으로 Foreign Key 이름을 지정해 준다.</p>\n<hr>\n<h3 id=\"onetomany\" style=\"position:relative;\"><a href=\"#onetomany\" aria-label=\"onetomany permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@OneToMany</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Inheritance</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">InheritanceType</span><span class=\"token punctuation\">.</span>JOINED<span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@DiscriminatorColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"auth_type\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Member</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>unique <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>mappedBy <span class=\"token operator\">=</span> <span class=\"token string\">\"owner\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Posting</span><span class=\"token punctuation\">></span></span> postingList<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>반대로 Member - Posting은 1:N이다.<br>\nDB 상의 Member 테이블에서는 Foreign key를 가지고 있지 않지만, 객체에서는 PostingList 정보가 필요할 수 있기 때문에 @OneToMany를 사용하여 필드로 불러올 수 있다. 이런 경우를 양방향 연관관계라고 한다. 여기서 <code class=\"language-text\">mappedBy</code> 옵션에는 상대방 Entity에서 자신을 지칭하는 필드명으로 지정해야 한다.</p>\n<hr>\n<h3 id=\"manytomany\" style=\"position:relative;\"><a href=\"#manytomany\" aria-label=\"manytomany permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@ManyToMany</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Hashtag</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>unique <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@NotNull</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> word<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Posting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> title<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> content<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"owner_id\"</span><span class=\"token punctuation\">,</span> nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Member</span> owner<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToMany</span>\n    <span class=\"token annotation punctuation\">@JoinTable</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"posting_hashtag\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Hashtag</span><span class=\"token punctuation\">></span></span> hashtagList<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1067px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/61b66ae5e83d12ed71e30b26d2f2c5e8/abe2a/posting-hashtag.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABJ0AAASdAHeZh94AAAA6klEQVQY002Ra3KDMAyEOUcTCCV+Ycc2r4aknWRy/0ttZYE9/NjRjFb6LMmVMgGXb41zI1BfJMesr3NXdKqvrOw1rSr1OZ9iFYYVuh+gSM4vUCaSKdkUypEXIbUvoBPBEyiODxg74ipv3C91oLxCtdxfnEiGUJ6MiLbr0QkLF1ZYUn+b6cERvZs533YGPt4ZknrSEMoMaGhTBqbXkpGhTat5JeN/YYYPJBUrO0Pbqaz6s76xPj88ZSccwxk4LX9I0N5NBAv76NvKKdY7YLuXLPeyNPUwPQpwG4RWzsXHpnKv/SOOOnr5s465f0HvrEnXXNThAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"posting-hashtag.png\"\n        title=\"posting-hashtag.png\"\n        src=\"/static/61b66ae5e83d12ed71e30b26d2f2c5e8/abe2a/posting-hashtag.png\"\n        srcset=\"/static/61b66ae5e83d12ed71e30b26d2f2c5e8/5a46d/posting-hashtag.png 300w,\n/static/61b66ae5e83d12ed71e30b26d2f2c5e8/0a47e/posting-hashtag.png 600w,\n/static/61b66ae5e83d12ed71e30b26d2f2c5e8/abe2a/posting-hashtag.png 1067w\"\n        sizes=\"(max-width: 1067px) 100vw, 1067px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>N:M 관계에서는 편리하게 @ManyToMany 옵션을 사용하면 자동으로 위와 같은 관계 테이블이 생성된다. 하지만 이런 경우 연관 관계를 표시하는 데이터에는 추가적인 정보를 저장할 수 없다. 따라서 실무에서는 대부분 두 테이블의 연결을 관리하는 별도의 Entity를 정의하여 사용한다.</p>\n<hr>\n<h3 id=\"nm-직접-정의하기\" style=\"position:relative;\"><a href=\"#nm-%EC%A7%81%EC%A0%91-%EC%A0%95%EC%9D%98%ED%95%98%EA%B8%B0\" aria-label=\"nm 직접 정의하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>N:M 직접 정의하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PostingHashtag</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"posting_id\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Posting</span> posting<span class=\"token punctuation\">;</span>\n    <span class=\"token annotation punctuation\">@ManyToOne</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"hashtag_id\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Hashtag</span> hashtag<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Posting과 Hashtag를 연결하는 PostingHastag Entity를 만들고, 각 Entity의 id를 Foreign key로 가지도록 @ManyToOne으로 연결해 주었다. 이렇게 N:M 관계를 위한 연결 Entity를 만들면 연결 정보에 추가적인 정보를 담을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Posting</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseEntity</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>mappedBy <span class=\"token operator\">=</span> <span class=\"token string\">\"posting\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PostingHashtag</span><span class=\"token punctuation\">></span></span> taggingList<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Posting에서는 연결된 Hashtag 정보를 조회하기 위해서 @OneToMany 로 연결하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1091px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ea82e32a11a11b18a8da0b4a006bdf77/01645/posting-hashtag_custom.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABJ0AAASdAHeZh94AAAA/klEQVQY001R2Y6CQBDkN3YVEYa5AIdbMepuYsz+/x/VTrWB+NCpTB/VVdPJLlU4HA3STGN/KMH3J2a5xbFwW/2zxvjeF1swn7Cx7RdY30HpZsOvXQHjAqb5hm5YUJ8m+HqIuVaGiVUzIlcVStPITJqZN2ETZmnQNgga14kyFwlcuEPZAdqcYPwYiWdRTLIqLilj3lW9BPMJZU/nB0J/QVHWsqmMxMxb32NY/mDrCYo108oSiqjDhOvtKcScI3H2JtQY5/tWZEHb1VbA4/eF8+VHFNionrb5V3TTDVf5Corgm65EIY/CB3E9EIeIufLRipfttMS+9TDrIdYDMf4BPeauLTuyRA8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"posting-hashtag_custom.png\"\n        title=\"posting-hashtag_custom.png\"\n        src=\"/static/ea82e32a11a11b18a8da0b4a006bdf77/01645/posting-hashtag_custom.png\"\n        srcset=\"/static/ea82e32a11a11b18a8da0b4a006bdf77/5a46d/posting-hashtag_custom.png 300w,\n/static/ea82e32a11a11b18a8da0b4a006bdf77/0a47e/posting-hashtag_custom.png 600w,\n/static/ea82e32a11a11b18a8da0b4a006bdf77/01645/posting-hashtag_custom.png 1091w\"\n        sizes=\"(max-width: 1091px) 100vw, 1091px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"-schema-\" style=\"position:relative;\"><a href=\"#-schema-\" aria-label=\" schema  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ Schema ]</h2>\n<p>앞에서 다룬 내용을 기반으로 Comment까지 마저 추가하면 다음과 같은 DB Schema를 구성할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/86c863b92312aefcea3848067b714f18/53ac9/db-schema.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABS0lEQVQoz51T7XKCQAzkNVpE5ePg4O6gCKgddepM3/+Z0mxsGD/on/7IMLdJNps1Rqt1Qf+JOMkp2Rhq/EC58VTajjappUiT94VLzX9h0/GLQrenomxpm9UUaQLfpcZ7gucAnhWOyQKTWVH8oBDAUqOuV1aB16qkebU20pObhgm94HjPhABqt5OJpmrnAhDdlDTkuyPnOrJuoJTfqPH9hd/jDcube0JLu+lEVf0hhCBeb0sJ1KB4PFzFfPiFN3LT5zcLGWZMPHxfZZIc9xdyYRQyDAARcF3Zt+PvFiCrBK9dzwKC/CDARCE8gXw0JxzqCQbpykoOXL0G9hanUqdeR5AZdmdetRfZaPL9STyBXximlvh2Ejtgi+LP1xCBAIcJYvXF8Wo4BeB6DplxFIYrFTzE2F5q4yR7JVQPH8/k9f7gzzCd538GPFtS+AMpcTYcw89QjQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"db-schema.png\"\n        title=\"db-schema.png\"\n        src=\"/static/86c863b92312aefcea3848067b714f18/c1b63/db-schema.png\"\n        srcset=\"/static/86c863b92312aefcea3848067b714f18/5a46d/db-schema.png 300w,\n/static/86c863b92312aefcea3848067b714f18/0a47e/db-schema.png 600w,\n/static/86c863b92312aefcea3848067b714f18/c1b63/db-schema.png 1200w,\n/static/86c863b92312aefcea3848067b714f18/53ac9/db-schema.png 1287w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>"},"primaryTag":{"name":"project","color":"#007acc"}},"pageContext":{"postId":"59fb98a3-5ba5-5485-a7fc-033b9da37083","primaryTag":"project"}},"staticQueryHashes":["1116962356","1994268275","2206391224","2275848304","545095672"]}
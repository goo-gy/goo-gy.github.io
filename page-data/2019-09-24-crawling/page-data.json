{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-post-tsx","path":"/2019-09-24-crawling","result":{"data":{"post":{"id":"a0ff4988-b1b7-5360-9b5c-a3b57881e46b","headings":[{"depth":1},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"크롤링(Crawling)을 해보자 [Python]","path":"/2019-09-24-crawling","tags":["project","crawling"],"excerpt":"urllib2와 beautiful-soup를 이용한 크롤링","created":"2019-09-24T00:00:00.000Z","createdPretty":"24 September, 2019","updated":"2019-09-24T00:00:00.000Z","updatedPretty":"24 September, 2019","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSElEQVQoz3WSS2gTURiFT9qNO0HQaNbuGhchRKpQF4p0ocuKChVUIq0bRXddZKdi0kVjKVWqU0zSTsKEUpvGRQi1tBiCoNUs+qS0DX0ITdtgmibmMfd4E/oIBf+ZfzFz7//dczkHkGXxWxD/Hcf46ji8s15Mrk8ikUogtBRC+5d2XJpqBVsegq33IMJhcGYGjMUgPB5wbAyMx0GLBYdlUkzQFjSocyq6f3Ubg4tB21ByyNo13XWh8VNjHR7LTbvA9s2r9fR6zWJiwsqREZtwu43yG0LTQJPpCOiIO0CyTjaSmaSSLWSZzqSLLDGvzQbMt74+woePbeCA1iAymTwXF4vc2SFXV5XKTHXW4TgCun64Kj8NlcWtvS11s7TJgb0BPfw3XH4+1dGElziPThhXtHeXWSzpIpvVqevkxoZamRFyVrhcR0Dnd+chkDn6+nP9RAplpFEyfTZcv9Fy7iRe4Mzb9/fvSNU5iZKvrLU1375CA53O/wD36FPyCpGFLp/c0w7DbeLUaQIn+Or1FVEolOS+SlPsA8VxYO2VU9mUmtbTHC4M66P5Uf3Nz06bhBnTwFlpQhPL5bI4ULi+rh4qrL1yrSlLf5YUisrxrJqizvvN3zqfgA/aIAYHG7i7mxfFolyTIpeXFbFviqg15SA2wYUgehO9Rt+cz9Y332d1T7vN1wIX66RCJGSzubmeHo+Zmmal328TPT1GBgLg8dgcBDu2EatmMbISQTQZrQbbPmZH88Iz8K5sux0MhcBoFIxEQFWtBrw22P8AIcy/GOORF0EAAAAASUVORK5CYII=","aspectRatio":2,"src":"/static/35d0b1fdb0a2edf5cd16931b1c9b224e/90823/crawling_web.png","srcSet":"/static/35d0b1fdb0a2edf5cd16931b1c9b224e/dc47e/crawling_web.png 200w,\n/static/35d0b1fdb0a2edf5cd16931b1c9b224e/9f2d5/crawling_web.png 400w,\n/static/35d0b1fdb0a2edf5cd16931b1c9b224e/90823/crawling_web.png 800w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<h1 id=\"-크롤링-crawling-\" style=\"position:relative;\"><a href=\"#-%ED%81%AC%EB%A1%A4%EB%A7%81-crawling-\" aria-label=\" 크롤링 crawling  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 크롤링 (Crawling) ]</h1>\n<p><strong>크롤링(Crawling)</strong>은 <strong>로봇(프로그램)</strong>이 스스로 웹사이트를 돌아다니면서 필요한 정보를 추출하고 행위를 의미합니다. 사람이 직접 브라우저를 통해 웹사이트들에서 정보를 얻어 수작업으로 기록하는 것 대신 크롤링을 이용하면 대량의 정보를 빠르게 추출할 수 있습니다. 프로그램이 정보 수집을 위해 페이지들을 긁고 기어다는 것이 거미가 기어 다니는 것 같다고 하여 <strong>크롤링(Crawling)</strong>이라는 이름이 붙었나 봅니다.  </p>\n<h2 id=\"-원리-\" style=\"position:relative;\"><a href=\"#-%EC%9B%90%EB%A6%AC-\" aria-label=\" 원리  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ 원리 ]</h2>\n<p>  크롤링을 하기에 앞서 웹 통신의 원리를 알아봅시다. (크롤링에 있어서도 큰 도움이 될 것입니다.)<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35d0b1fdb0a2edf5cd16931b1c9b224e/5a190/crawling_web.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSElEQVQoz3WSS2gTURiFT9qNO0HQaNbuGhchRKpQF4p0ocuKChVUIq0bRXddZKdi0kVjKVWqU0zSTsKEUpvGRQi1tBiCoNUs+qS0DX0ITdtgmibmMfd4E/oIBf+ZfzFz7//dczkHkGXxWxD/Hcf46ji8s15Mrk8ikUogtBRC+5d2XJpqBVsegq33IMJhcGYGjMUgPB5wbAyMx0GLBYdlUkzQFjSocyq6f3Ubg4tB21ByyNo13XWh8VNjHR7LTbvA9s2r9fR6zWJiwsqREZtwu43yG0LTQJPpCOiIO0CyTjaSmaSSLWSZzqSLLDGvzQbMt74+woePbeCA1iAymTwXF4vc2SFXV5XKTHXW4TgCun64Kj8NlcWtvS11s7TJgb0BPfw3XH4+1dGElziPThhXtHeXWSzpIpvVqevkxoZamRFyVrhcR0Dnd+chkDn6+nP9RAplpFEyfTZcv9Fy7iRe4Mzb9/fvSNU5iZKvrLU1375CA53O/wD36FPyCpGFLp/c0w7DbeLUaQIn+Or1FVEolOS+SlPsA8VxYO2VU9mUmtbTHC4M66P5Uf3Nz06bhBnTwFlpQhPL5bI4ULi+rh4qrL1yrSlLf5YUisrxrJqizvvN3zqfgA/aIAYHG7i7mxfFolyTIpeXFbFviqg15SA2wYUgehO9Rt+cz9Y332d1T7vN1wIX66RCJGSzubmeHo+Zmmal328TPT1GBgLg8dgcBDu2EatmMbISQTQZrQbbPmZH88Iz8K5sux0MhcBoFIxEQFWtBrw22P8AIcy/GOORF0EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"crawling web\"\n        title=\"crawling web\"\n        src=\"/static/35d0b1fdb0a2edf5cd16931b1c9b224e/5a190/crawling_web.png\"\n        srcset=\"/static/35d0b1fdb0a2edf5cd16931b1c9b224e/5a46d/crawling_web.png 300w,\n/static/35d0b1fdb0a2edf5cd16931b1c9b224e/0a47e/crawling_web.png 600w,\n/static/35d0b1fdb0a2edf5cd16931b1c9b224e/5a190/crawling_web.png 800w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br>\n먼저 사용자가 대상 서버에 정보를 요청합니다 (<strong>Request</strong>). 그러면 서버는 사용자에게 요청한 페이지 소스를 보내줍니다 (<strong>Response</strong>). 브라우저는 서버로부터 받은 <strong>페이지 소스(Page Source)</strong>를 분석하여 사용자에게 화면으로 보여줍니다.  </p>\n<p>  크롤링을 하려면 다음의 과정을 이해하고 구현해야 합니다.    </p>\n<ol>\n<li><strong>웹 서버와 통신</strong></li>\n<li><strong>페이지 소스 분석 (Parsing)</strong></li>\n</ol>\n<p>  사용자가 직접 웹서핑을 할 때는 브라우저가 알아서 정보를 요청하고 받은 페이지 소스를 분석하여 사용자에게 보내줍니다. 크롤링을 하기 위해서는 프로그램에서 <strong>정보를 요청하는 통신</strong>과 <strong>페이지 소스를 분석</strong>하는 과정이 필요합니다.  </p>\n<h2 id=\"웹-서버와-통신-urllib2\" style=\"position:relative;\"><a href=\"#%EC%9B%B9-%EC%84%9C%EB%B2%84%EC%99%80-%ED%86%B5%EC%8B%A0-urllib2\" aria-label=\"웹 서버와 통신 urllib2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹 서버와 통신 [urllib2]</h2>\n<p>  <strong>urllib2</strong> 라이브러리를 이용하면 편리하게 웹서버와 통신할 수 있습니다. </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib2\n\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://goo-gy.github.io/posts/\"</span>\nrequest <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\nresponse <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>  urllib2.Request()는 url을 인자로 받아 정보를 요청할 Request 객체를 생성합니다. Request 객체를 통해서 url에 접속만 하는 것이 아니라 추가적인 작업을 할 수 있습니다.  </p>\n<ul>\n<li>\n<p><strong>Request</strong>  </p>\n<ul>\n<li><strong>.add_header(\"header\", \"value\")</strong><br>\nRequest의 <strong>헤더(Header)</strong>를 추가할 수 있습니다. 이를 이용해 <strong>Cookie, User-Agent, Referer</strong> 등을 추가할 수 있습니다.  </li>\n<li><strong>.add_data(\"param=data\")</strong><br>\n<strong>POST 메서드</strong>로 데이터를 보낼 수 있습니다.  </li>\n</ul>\n</li>\n</ul>\n<p>  urllib2.urlopen()은 url 혹은 Request 객체를 가지고 서버에 정보를 요청하고 받아와 Response 객체를 생성합니다.  </p>\n<ul>\n<li>\n<p><strong>Response</strong>  </p>\n<ul>\n<li><strong>.read()</strong><br>\nResponse에서 페이지 소스를 반환합니다.  </li>\n<li><strong>.code</strong><br>\nResponse의 응답 코드입니다.</li>\n<li><strong>.headers</strong><br>\nResponse의 헤더들이 담긴 사전(Dictionary)처럼 저장되어 있습니다.  </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"웹-페이지-파싱-beautiful-soup\" style=\"position:relative;\"><a href=\"#%EC%9B%B9-%ED%8E%98%EC%9D%B4%EC%A7%80-%ED%8C%8C%EC%8B%B1-beautiful-soup\" aria-label=\"웹 페이지 파싱 beautiful soup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹 페이지 파싱 [beautiful-soup]</h2>\n<p>  웹페이지 소스는 <strong>HTML</strong>이라는 형식으로 구성되어 있는데, Beautiful Soup가 문자열로 얻어진 웹 페이지 소스를 분석하여 <strong>HTML</strong> 구조에서 필요한 정보를 추출할 수 있도록 도와줍니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">--------------------Element--------------------\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>크롤링-crawling<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>크롤링 (Crawling)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\nTag     Attribute                          Tag</code></pre></div>\n<p>  HTML에는 기본적으로 구조를 나누는 <strong>태그(Tag)</strong>와 구체화시키는 <strong>속성(Attribute)</strong>이 있습니다. 이 태그와 속성을 이용하여 우리가 원하는 정보를 찾을 수 있습니다. 그리고 태그들로 감싸진 부분을 <strong>엘리먼트(Element)</strong>라고 합니다.<br>\nBeautiful Soup를 이용하여 우리는 HTML에서 원하는 정보를 쉽게 추출할 수 있습니다.  </p>\n<p>  Beautiful Soup는 내장 라이브러리가 아니기 때문에 설치가 필요합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># pip install bs4  </code></pre></div>\n<p>  예제로 Beautiful Soup를 이용하여 제 블로그의 포스트 목록에서 제목들을 가져오겠습니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib2\n<span class=\"token keyword\">from</span> bs4 <span class=\"token keyword\">import</span> BeautifulSoup\n\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://goo-gy.github.io/posts/\"</span>\nrequest <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\nresponse <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\npage_source <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\npage_html <span class=\"token operator\">=</span> BeautifulSoup<span class=\"token punctuation\">(</span>page_source<span class=\"token punctuation\">,</span> <span class=\"token string\">\"html.parser\"</span><span class=\"token punctuation\">)</span>\npost_table <span class=\"token operator\">=</span> page_html<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"post-list\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\npost_list <span class=\"token operator\">=</span> post_table<span class=\"token punctuation\">.</span>find_all<span class=\"token punctuation\">(</span><span class=\"token string\">\"li\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> post <span class=\"token keyword\">in</span> post_list<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>\n<p><strong>find(name, attrs, recursive, string, **kwargs)</strong><br>\nfind는 조건에 맞는 태그 중 소스에서 가장 앞에 위치한 요소 하나를 가져옵니다.  </p>\n<ul>\n<li><strong>name</strong>: 태그명으로 검색합니다.  </li>\n<li><strong>attrs</strong>: 특정 속성의 값으로 검색합니다.  </li>\n<li><strong>recursive</strong>: 해당 요소 내부에서 재귀적으로 검색할지 선택합니다. (True 이면 하위에 있는 모든 요소에서 검색하며 False 이면 내부의 최상위 요소들에서만 검색합니다.)  </li>\n<li><strong>string</strong>: 내부 문자열을 검색합니다. 문자열 자체 혹은 정규 표현식으로 입력할 수 있습니다.\n<em>※ HTML은 트리 구조입니다. recursive를 준다면 손자 요소들에서도 검색합니다.</em>  </li>\n</ul>\n</li>\n<li>\n<p><strong>find_all(name, attrs, recursive, string, limit, **kwargs)</strong><br>\nfind_all은 조건에 맞는 요소(Element)를 모두 가져와 리스트처럼 사용할 수 있습니다.  </p>\n<ul>\n<li><strong>name</strong>: 태그명으로 검색합니다.  </li>\n<li><strong>attrs</strong>: 특정 속성의 값으로 검색합니다.  </li>\n<li><strong>recursive</strong>: 해당 요소 내부에서 재귀적으로 검색할지 선택합니다. (True 이면 하위에 있는 모든 요소에서 검색하며 False 이면 내부의 최상위 요소들에서만 검색합니다.)  </li>\n<li><strong>string</strong>: 내부 문자열을 검색합니다. 문자열 자체 혹은 정규 표현식으로 입력할 수 있습니다.</li>\n<li><strong>limit</strong>: 매칭되는 결과의 수를 제한합니다.  </li>\n</ul>\n</li>\n<li>\n<p><strong>Example</strong></p>\n<ul>\n<li>\n<p>태그로 검색하기  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">page_html<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>태그와 속성값으로 검색하기</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">page_html<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"post-list\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>class와 같이 파이썬의 예약어로 등록되어 있는 단어는 오류가 나기 때문에 뒤에 _를 붙여주는 것을 허용합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">page_html<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">,</span> class_<span class=\"token operator\">=</span><span class=\"token string\">\"post-list\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>딕셔너리 형태로 여러 개의 속성을 지정할 수 있습니다. (저는 한 개만 하더라도 예약어 문제가 없기 때문에 이 방법을 선호합니다.) </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">page_html<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"post-list\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>태그와 문자열로 검색하기</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">page_html<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> string<span class=\"token operator\">=</span><span class=\"token string\">\"트리 (Tree)\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"-robotstxt-\" style=\"position:relative;\"><a href=\"#-robotstxt-\" aria-label=\" robotstxt  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ robots.txt ]</h2>\n<p>  <strong>robots.txt</strong>는 웹페이지가 로봇(크롤러)에게 지켜달라고 지정해놓은 규약입니다. 기능적으로 강제성이 있지는 않지만 대상 <strong>웹 서버에 대한 예의</strong>라고 할 수 있습니다. 크롤링이 사람이 직접 하는 것보다 빠르게 접속하는 만큼 웹 서버에도 부하가 커질 수 있기 때문입니다. robots.txt에는 크롤링 금지 경로, 허용 경로, 최소 딜레이 등이 포함되어 있습니다.  </p>\n<ul>\n<li><strong>User-agent</strong><br>\n대상 Agent</li>\n<li><strong>Disallow</strong><br>\n금지 경로</li>\n<li><strong>Allow</strong><br>\n허용 경로</li>\n<li><strong>Crawl-delay</strong><br>\n최소 딜레이 간격  </li>\n</ul>\n<p>  더 자세한 내용은 [<a href=\"https://support.google.com/webmasters/answer/6062596?hl=ko&#x26;ref_topic=6061961\">Google robots.txt</a>]를 참고하시기 바랍니다.<br>\n<strong>robotparser</strong>를 이용하면 내 크롤러가 <strong>robots.txt</strong>의 내용을 지키도록 적용할 수 있습니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> robotparser\n<span class=\"token keyword\">import</span> urllib2\n\nrobot_url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://goo-gy.github.io/robots.txt\"</span>\nrobot <span class=\"token operator\">=</span> robotparser<span class=\"token punctuation\">.</span>RobotFileParser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nrobot<span class=\"token punctuation\">.</span>set_url<span class=\"token punctuation\">(</span>robot_url<span class=\"token punctuation\">)</span>\nrobot<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://goo-gy.github.io/posts/\"</span>\nrequest <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\nrequest<span class=\"token punctuation\">.</span>add_header<span class=\"token punctuation\">(</span><span class=\"token string\">'User-agent'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'python-urllib2'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> robot<span class=\"token punctuation\">.</span>can_fetch<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'User-agent'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  response <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>\n<p><strong>RobotFileParser()</strong>  </p>\n<ul>\n<li><strong>.set_url(url)</strong><br>\n읽어들일 robots.txt의 url 경로를 지정합니다.  </li>\n<li><strong>.read()</strong><br>\n지정해둔 url에서 robots.txt를 읽어들입니다.  </li>\n<li><strong>.can_fetch(agent, url)</strong><br>\n입력한 url에 입력한 robot agent의 접속 허용 여부를 반환합니다.  </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"-tips-\" style=\"position:relative;\"><a href=\"#-tips-\" aria-label=\" tips  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ Tips ]</h2>\n<h3 id=\"정보-위치-찾기\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%B3%B4-%EC%9C%84%EC%B9%98-%EC%B0%BE%EA%B8%B0\" aria-label=\"정보 위치 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;정보 위치 찾기></h3>\n<p>  <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f9e8ab13654c20393ee64e1628778b61/29114/crawling_chrome.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACrklEQVQoz3WS2U9TQRSH7x+DqEDUaGlZqoA8qFExcUHjk2hMUMKLshhfjQ+KS8DI5gpdNAQRFKMCYt1IXBKVRRChpi2UikDb2/b23t7Wz2kTjYl6Mr+cmcmZL79zMtKubVsp21tKSXEReTk5GIwmDNnGv7TOYCA3L58NBYUUFm2korKSY9W1HK+qSqmqupqamlqk0lwTW7IyOXeiht7ubixWKzabPSW73Y7VasNisXD3bjdHysvJyspivXk94xPjKLpGSIkQjkaJqFG0mIa0yZiNKT2d+52dJCMeU+FHQixd5Lg4a8REcTIaGhpIF7X5ZjPjYyPoqoImYAld1CYSxDUVKV8A16xIx9rWxttRJwNDH5lZVH5r1q/i+i5ciDd1Z8+QlpaG2ZzPy/cTTM1FGHOHmF6I4fQnmJpXkHIEMFMA20VbPR+WON87wRWHh+svvNx4OZdS06AHx3SUpsbLYp4mtpfsYNLpYlHWcXoW8fiCeBcUFoICaDQaWLl8WQrY/1mh5ekMbUM+br7ypWBtIjeLu+dOlfqLF1hrMLJzzz7cbjeJWBxZDqNqOroeF63HkIryTKzKyMAmhv/wU4jGAVcKcvPVXAqa3Lc4ZhmYkHnz9h2dvf0MT34lHBbzUzT+jLiYo3Rocx7Fq1dit1h5NB6medCdgvxqN7lvfebl4cgi+g/wBVUmXV583xaIhMIEgwH8fj9aWCYWFS1fqynl5O4cujpu8WBMpumJ6y9g0uHgZIS+Bz1UlO2n9ugBXNNTJOJxNC2G7F9i7HU7zuEeJOvpCuoPFvDm8R3uj4b+6bDFMcOAAA712rlUe4A+Wz2BeR+q+DJRVUUJh5ib6sP7xYHUUVdNa3kxo44e7o3832H/5wifHF3cPnWYF11XmZ/1EAoGhUMNORBAC8gEhH4Cs5anCecT9dYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"crawling chrome\"\n        title=\"crawling chrome\"\n        src=\"/static/f9e8ab13654c20393ee64e1628778b61/c1b63/crawling_chrome.png\"\n        srcset=\"/static/f9e8ab13654c20393ee64e1628778b61/5a46d/crawling_chrome.png 300w,\n/static/f9e8ab13654c20393ee64e1628778b61/0a47e/crawling_chrome.png 600w,\n/static/f9e8ab13654c20393ee64e1628778b61/c1b63/crawling_chrome.png 1200w,\n/static/f9e8ab13654c20393ee64e1628778b61/d61c2/crawling_chrome.png 1800w,\n/static/f9e8ab13654c20393ee64e1628778b61/29114/crawling_chrome.png 1920w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>  </p>\n<ul>\n<li>Chrome의 <strong>개발자 도구(F12)</strong>를 이용하면 내가 원하는 원하는 정보에 어떻게 접근해야 할지 쉽게 알 수 있습니다. ctrl + shift + c를 누르고 추출하려는 부분에 마우스를 올리면 개발자 도구에서 해당 html 태그를 보여줍니다.  </li>\n<li>크롤링 하면서 생각처럼 작동이 안 될 때는 <a href=\"https://portswigger.net/burp/communitydownload\">Burp-suite</a> 등의 <strong>Proxy 툴</strong>을 이용하여 오가는 HTTP 메세지를 잡아서 확인해 보는 것이 도움이 될 수 있습니다. 앞에서 설명한 것처럼 웹페이지는 사용자와 서버의 통신으로 이루어지는데 일반 브라우저로 접속했을 때와 내가 만든 크롤러로 접속했을 때의 패킷을 비교해보면 무엇이 잘못되었는지 파악할 수 있습니다.  </li>\n</ul>\n<h3 id=\"메서드-변경하기\" style=\"position:relative;\"><a href=\"#%EB%A9%94%EC%84%9C%EB%93%9C-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0\" aria-label=\"메서드 변경하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;메서드 변경하기></h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib2\n\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://goo-gy.github.io\"</span>\n\nrequest <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\nrequest<span class=\"token punctuation\">.</span>get_method <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'GET'</span><span class=\"token punctuation\">;</span>\nresponse <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\npage_source <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>page_source<span class=\"token punctuation\">)</span></code></pre></div>\n<p>  제 블로그는 GET 메서드 이외의 메서드는 막혀 있기 때문에 에러가 발생합니다.  </p>\n<h3 id=\"http-응답상태-코드-http-status-code\" style=\"position:relative;\"><a href=\"#http-%EC%9D%91%EB%8B%B5%EC%83%81%ED%83%9C-%EC%BD%94%EB%93%9C-http-status-code\" aria-label=\"http 응답상태 코드 http status code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;HTTP 응답[상태] 코드 (HTTP Status Code)></h3>\n<p>  <strong>HTTP 응답 코드</strong>는 response.code로 확인할 수 있습니다. 하지만 <strong>[ 200 OK ]</strong> 등의 요청 성공 이외의 코드들은 response 객체를 생성하기 전에 오류가 나기 때문에 별도의 에러 처리를 해야 응답 코드를 얻을 수 있습니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib2\n\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://goo-gy.github.io\"</span>\nrequest <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\nmethod_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'HEAD'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'OPTIONS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PUT'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'DELETE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'TRACE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CONNECT'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> method <span class=\"token keyword\">in</span> method_list<span class=\"token punctuation\">:</span>\n  request<span class=\"token punctuation\">.</span>get_method <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span><span class=\"token punctuation\">:</span> method<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n      response <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">except</span> urllib2<span class=\"token punctuation\">.</span>HTTPError <span class=\"token keyword\">as</span> error<span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># python2 method_test.py\n(&#39;GET&#39;, 200)\n(&#39;POST&#39;, 405)\n(&#39;HEAD&#39;, 200)\n(&#39;OPTIONS&#39;, 405)\n(&#39;PUT&#39;, 405)\n(&#39;DELETE&#39;, 405)\n(&#39;TRACE&#39;, 405)\n(&#39;CONNECT&#39;, 405)</code></pre></div>\n<p>  HTTP 상태 코드 : <a href=\"https://developer.mozilla.org/ko/docs/Web/HTTP/Status\">https://developer.mozilla.org/ko/docs/Web/HTTP/Status</a><br>\n</p>"},"primaryTag":{"name":"project","color":"#007acc"}},"pageContext":{"postId":"a0ff4988-b1b7-5360-9b5c-a3b57881e46b","primaryTag":"project"}},"staticQueryHashes":["1116962356","1994268275","2206391224","2275848304","545095672"]}